## TCP

#### TCP是什么，它和UDP有什么区别

TCP被是一个面向连接的，字节流的可靠传输协议

UDP是一个面向无连接的，轻量级传输协议

#### TCP是如何保证可靠传输的

TCP拥有序列号与确认应答，超时重传，滑动窗口，流量控制，拥塞控制等机制来保证可靠传输

####  介绍TCP超时重传机制

当我发送给目标主机一个TCP报文的时候，服务器会返回一个确认报文，这样如果我的数据包就算丢失了，没有得到确认报文，在一定时间后我就会重传之前的报文，这就是超时重传的基本原理

在重传机制的具体实现上，存在诸多细节

例如超时重传时间的选择，根据以往的超时时间来计算平滑值，再根据RTO和平滑值的差距来取梯度值，梯度值和平滑值共同得出现在的超时重传时间

然后还有快速重传机制，确认号是传输数据中，接收端没有接受到的报文的最小序列号，所以当多个数据报传输过来之后，之前有一个报文未接受，后面的报文的确认号都是这个报文的序列号，当三个相同的确认报文传输过来之后，这个报文直接重传，无需等待超时

#### 介绍TCP滑动窗口

一个TCP连接中会维护三个窗口，分别是发送窗口，接受窗口与拥塞窗口，在一个TCP数据链中，数据分为三个部分，以发送并且已经确认接受，不可发送，可发送并仍在缓存中，其中可发送并仍在缓存中，就是发送窗口所包含的部分。在发送窗口中的数据，发送端会一次的发送给客户端，当受到ACK后，发送端知道哪些数据仍然未被接受，并且快速重传或超时重传这些数据包，在发送的过程中，发送端会尝试将发送窗口尽可能的向前移动，并停止在仍然未接受到确认的数据。

同理接受窗口会受到数据，并且移动窗口到仍然未接受到数据的地方停止。

通过滑动窗口机制，防止了队头阻塞（一个一个传效率过低），和盲目发送（一次性发送太多会造成数据拥塞）

#### 介绍TCP的流量控制

有时候接收端服务繁忙，会造成接受窗口的大小改变，这时候接收端就会通知发送端，要求发送端重新也调整自己的发送窗口大小

#### 介绍TCP的拥塞控制

为了感知网络通讯的繁忙状态，并调整自己的发送速度，防止过多无意义的重传导致网络拥塞，TCP具有一套拥塞控制算法

1. 慢开始算法：最开始的时候拥塞窗口大小为1，并且随着数据包发送与接受，慢开始会逐渐的指数级增加自己的拥塞窗口大小，直到系统内置的**慢开始门限**大小结束，并进入拥塞避免算法
2. 拥塞避免算法：每接受一个数据包，拥塞窗口的变换不再是倍数增长，而是慢慢的线性增加拥塞窗口的大小
   1. 如果发生了超时重传，说明网络拥塞较为严重，那么拥塞窗口大小会重新回到1，慢启动门限变为当前拥塞窗口的一半，并进入慢开始算法
   2. 如果发生了快速重传，说明网络拥塞不严重，但需要仍然需要控制，那么拥塞窗口大小会变成原来的一半，慢开始门限变为现在的拥塞窗口大小，进入快恢复算法
3. 快恢复算法：因为快速重传表明拥塞并不严重，所以快速重传后，如果又受到来自该数据包的ACK,那么需要增加拥塞控制窗口来保证数据的正常传输，当接受到新的ACK时，拥塞窗口会重新回到慢开始门限大小，并进入拥塞避免算法

#### Linux如何查看TCP连接

**ss：**

- `ss` 是一个类似于 `netstat` 的工具，用于显示套接字统计信息。
- `ss -t`：显示TCP连接。
- `ss -l`：显示所有监听的套接字。

**lsof：**

- `lsof` 是一个可以列出打开文件和套接字的工具。
- `lsof -i TCP`：显示所有使用TCP协议的网络连接。

**tcpdump：**

- `tcpdump` 是一个网络数据包分析工具，可以捕获和显示网络流量。
- `tcpdump tcp`：显示所有TCP流量。

**nmap：**

- `nmap` 是一个网络探测和安全审核工具，也可以用于查看开放的端口和TCP连接。
- `nmap -p 1-1000 localhost`：扫描本地主机的前1000个端口。

**ip：**

- `ip` 命令可以用来显示和配置网络接口、路由表等信息。
- `ip tcp_metrics`：显示TCP连接的性能指标。

## HTTP/HTTPS

#### 介绍什么是HTTP，与HTTPS的区别是什么

HTTP全称超文本传输协议，他是应用层协议，主要用于网络数据的传输，也用于用户浏览的网页页面的传输

HTTPS是HTTP的扩展，他使用非对称加密技术对密钥进行加密传输，数字证书验证安全，防止假基站窃听数据

#### HTTP/1.0如何优化

1. 设置长连接：长连接可以请求多次而不关闭TCP连接，防止TCP握手和挥手建立连接导致效率底下
2. 强制缓存：服务端发送资源的时候，在头部加上字段Cache-Control和相对过期时间，浏览器再次发送相同请求的时候，会检查资源是否过期，如果没过期，那么直接使用缓存中的资源
3. 协商缓存：服务端发送资源的时候，在头部加上Last-Modified和最后修改时间，浏览器发送相同请求的时候会带上If-Modified-Since和资源的时间，服务端会检查该资源是否被修改，如果没有，那么发送304响应告诉客户端可以走缓存，如果修改了，那么发送200并带上最新资源

#### HTTP/1.1相较于HTTP/1.0做了哪些优化

默认支持长连接（当请求和响应来回之后，不会关闭TCP连接）

客户端不必等待响应，就可以发送下一个数据

#### HTTP/2做了哪些优化

头部压缩：通过双方动态维护的头字段表，发送端可以只发送字段表的索引来表示对应的字段名称

二进制格式：请求头GET/POST和路由URL会压缩成二进制格式，整个报文会变成两个帧，一个头部信息帧，一个数据帧

并发传输：一个TCP多个请求连接并发传输，每个请求和响应都有固定的Stream标识，交错发送不会乱序

服务器推送：服务端不必等待客户端数据发送请求，可以直接发送响应

#### HTTP/3做了什么优化

无队头阻塞：改用UDP连接，当某个流发送数据丢失的时候，该流阻塞，但是其他流不会受到影响

更快的连接建立：使用UDP避免了三次握手，同时使用QUiC协议建立连接，合并了TLS连接的步骤

连接迁移：当网络连接改变的时候（IP地址发生改变），QUIC可以防止重新三次握手，直接复用之前的连接

#### HTTPS如何保证数据传输的安全性



## IP

### ICMP协议的作用有哪些

ICMP有几种类型

回送请求和回送应答：用来查看网络延迟

目标不可达：如果发现路由表不存在关于该IP的任何信息，那么会回送目标不可达

原点抑制：网络某处的发送端的发送缓存队列已满，那么返回此响应

超时：每个ICMP请求都会有一个信息表明自己的生命周期，每转发一次都会减一，如果减小到0，那么该报文丢弃，返回此响应

