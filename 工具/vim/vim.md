## VIM

### VIM 四种模式

####  正常模式 (Normal-mode)

正常模式用于浏览文件，也包含一些复制、粘贴、删除等操作，这时击键，一些组合键就是 vim 的功能键，而不会在文本中键入对应的字符

#### 插入模式 (Insert-mode)

在正常模式中按下个别字母键（后面会详细介绍），会进入插入模式。

例如按 `i` 键会进行插入模式。该模式启动以后，就会进入编辑状态，通过键盘输入内容。

#### 命令模式 (Command-mode)

按下`：`（冒号）键或者`/` （斜杠），会进入命令模式。在命令模式中可以执行一些输入并执行一些 VIM 或插件提供的指令，就像在shell里一样。这些指令包括设置环境、文件操作、调用某个功能等等

#### 可视模式 (Visual-mode)

在正常模式按下`v, V, <Ctrl>+v`，可以进入可视模式。可视模式中的操作有点像拿鼠标进行操作，选择文本的时候有一种鼠标选择的即视感，有时候会很方便

VIM 也可分为两种模式

- 操作模式
- 编辑模式

### VIM打开文件

#### 打开单个文件

```bash
vim file1
```

#### 打开多个文件

```bash
vim file1 file2
```

当打开多个文件时只会显示一个文件的编辑界面

在命令模式中输入`:ls`会显示所有文件，再输入`:b3`即可切换文件到第三个文件

<img src="/home/LanQiDongLai/.config/Typora/typora-user-images/image-20230904212305235.png" alt="image-20230904212305235" style="zoom:80%;" />

在命令模式下有以下指令

- `:saveas file`另存为，并打开文件

- `:e file` 不分屏打开另一文件

#### 打开多个文件（分屏显示）

```bash
#这里的O3的数字三指的是打开三个文件
#O表示左右分屏，o表示上下分屏
vim -O3 file1 file2 file3
vim -o3 file1 file2 file3
```

<img src="/home/LanQiDongLai/.config/Typora/typora-user-images/image-20230904212805615.png" alt="image-20230904212805615" style="zoom:80%;" />

移动光标详见[VIM分屏](#VIM分屏)

### VIM分屏

在正常模式下按下`Ctrl + w`再输入`s`表示对当前文件上下分屏或者输入`v`表示左右分屏

或者在命令模式下输入`:sp`示上下分屏或者输入`:vsp`表示左右分屏

输入`:sp file2`或者`:vsp file2`打开新的文件，并上下或左右分屏

#### 如何移动光标？

在正常模式下按下`Ctrl + w`再输入`{k,j,h,l}`表示光标移动到`{上，下，左，右}`分屏

#### 如何移动分屏？

在正常模式下按下`Ctrl + w`再输入`{k,j,h,l}`表示分屏做`{上，下，左，右}`移动

#### 如何关闭分屏？

在正常模式下按下`Ctrl + w`再输入`c`表示关闭分屏，或者输入`q`表示关闭分屏

两者区别在于`c`无法关闭最后一个分屏

### VIM如何保存和退出

命令模式下

- `:w`保存
- `:w!`强制保存
- `:w file`保存到指定文件，不存在则新建
- `:q`退出
- `:q!`强制退出
- `:saveas file`另存为，并打开文件
- `:e file` 不分屏打开另一文件

正常模式下

连续按下两个键`ZZ`即可快速保存退出

### VIM如何进入插入模式

- `i`是在光标所在的字符之前插入需要录入的文本。

- `I` 是在光标所在行的行首插入需要录入的文本。

- `a` 是在光标所在的字符之后插入需要录入的文本。

- `A` 是在光标所在行的行尾插入需要录入的文本。

- `o` 是光标所在行的下一行行首插入需要录入的文本。

- `O` 是光标所在行的上一行行首插入需要录入的文本。

- `s` 删除光标所在处的字符然后插入需要录入的文本。

- `S` 删除光标所在行，在当前行的行首开始插入需要录入的文本。

> 修改某一个单词，在正常模式下连续输入`cw`删除从光标处到单词结尾的字符，并进入输入模式

### VIM行号

命令模式下`:set nu`或者`:set number`显示行号

命令模式下`:set nonu`或者`:set nonumber`关闭显示行号

命令模式下`:14`表示跳转到14行

### VIM查找

命令模式下输入`/abc`即可在文件中查找所有`包含abc字符串`，并将光标移动到第一个匹配的字符串首部

#### 如何忽略大小写？

提前在命令模式输入设置忽略大小写`:set ic`

命令模式输入`:set noic`开始区分大小写

或者按照该格式在命令模式输入`/\Cabc`，表示匹配所有`包含忽略大小写的abc字符串`

### VIM删除文本

在vim中删除和剪切是同义词，删除的内容会存放到剪切板中，在正常模式下输入`p`粘贴，在删除前添加`_`如`_dd`，那么剪切会添加到黑洞寄存器，也就是不保存删除内容

正常模式

- `x`删除一个字符
- `dw`截取一个单词，从光标（含光标）到下一个单词开头
- `db`截取一个单词，从光标到该单词开头
- `dd`删除一行
- `4dd`删除四行
- `D`或`d$`从光标（含光标）删除到行末
- `d0`从行首删除到光标

可视模式

选中一块区域，输入`d`即可删除

命令模式

- `:2,5d`删除第二行到第五行
- `:%s/abc//g`删除全文中匹配`abc`的字符串

### VIM替换文本

命令模式下`:{作用范围}s/{正则目标}/{替换}/{替换的标志}`

例如`:%s/abc/zxc/g`表示将全文的`abc`替换成`zxc`

#### 作用范围

- 作用范围分为所在行，全文，选区
- `空`表示当前行
- `%`表示全文
- `2,5`表示从第二行到第五行
- 如果在可视模式下，切入到命令模式会自动补全为`:'<,'>`，表示当前选区

<img src="/home/LanQiDongLai/.config/Typora/typora-user-images/image-20230905093933723.png" alt="image-20230905093933723" style="zoom:80%;" />

#### 替换标志

- `空`表示只替换从光标处第一次出现的待替换文本
- `g`表示替换作用范围中所有待替换文本
- `i`表示匹配忽略大小写
- `c`表示确认替换

### VIM执行Linux命令

在命令模式下执行`:!command`跳出文本编辑器界面输出命令的结果

`:!date`输出日期

在命令模式下执行`:r !command`或`:r !command`将结果插入到光标所在下一行

### VIM正常模式快捷键

#### 移动光标

- `hjkl`分别代表左下上右移动

- 在当前行上移动光标

  `0 ` 移动到行头

  `^`   移动到本行的第一个不是 blank 字符

  `$`  移动到行尾

  `g_`  移动到本行最后一个不是 blank 字符的位置

  `w` 光标移动到下一个单词的开头

  `e`  光标移动到下一个单词的结尾

  `fa`  移动到本行下一个为 a 的字符处，fb 移动到下一个为 b 的字符处

  `nfa` 移动到本行光标处开始的第 n 个 字符为 a 的地方（n 是 1，2，3，4 ... 数字）

  `Fa` 同 `fa` 一样，光标移动方向同 `fa` 相反

  `nFa` 同 `nfa` 类似，光标移动方向同 `nfa`相反

  `ta` 移动光标至 a 字符的前一个字符

  `nta` 移动到第二个 a 字符的前一个字符处

  `Ta` 同 `ta` 移动光标方向相反

  `nTa` 同 `nta` 移动光标方向相反

  `;` 和`,` 当使用 f, F, t ,T, 关键字指定字符跳转的时候，使用 `；`可以快速跳转到下一个指定的字符，`, ` 是跳到前一个指定的字符

- 跨行移动光标

  `nG ` 光标定位到第 n 行的行首

  `gg ` 光标定位到第一行的行首

  `G `  光标定位到最后一行的行首

  `H ` 光标定位到当前屏幕的第一行行首

  `M`   光标移动到当前屏幕的中间

  `L` 光标移动到当前屏幕的尾部

  `zt` 把当前行移动到当前屏幕的最上方，也就是第一行

  `zz` 把当前行移动到当前屏幕的中间

  `zb` 把当前行移动到当前屏幕的尾部

  `%`   匹配括号移动，包括 ( , { , [  需要把光标先移动到括号上

  `*` 和 `#` 匹配光标当前所在的单词，移动光标到下一个（或者上一个）匹配的单词（ `*` 是下一个，`#` 是上一个）

- 翻页

  `ctrl+f` 查看下一页内容

  `ctrl+b` 查看上一页内容

#### 删除

`d` 是删除的意思，通常搭配一个字符 ( 删除范围 ) 实现删除功能，常用的如下：

`dw` 删除一个单词

`dnw` 删除 n 个单词，

`dfa` 删除光标处到下一个 a 的字符处（ fa 定位光标到 a 处 ）

`dnfa` 删除光标处到第 n 个 a 的字符处

`dd` 删除一整行

`ndd` 删除光标处开始的 n 行

`d$` 删除光标到本行的结尾

`dH` 删除屏幕显示的第一行文本到光标所在的行

`dG` 删除光标所在行到文本的结束

#### 复制

`y` 是复制的意思，通常搭配一个字符（复制范围）实现复制的功能，常用的如下：

`yw` 复制一个单词，还有 `ynw`

`yfa` 复制光标到下一个 a 的字符处,还有`ynfa`

`yy` 复制一行，还有 `nyy`

`y$` 复制光标到本号的结尾

`yH` 复制屏幕显示的第一行文本到光标所在的行

`yG` 复制光标所在行到文本的结束

#### 粘贴

`p` ，`P`是黏贴的意思，当执行完复制或者黏贴的命令以后，VIM 会把文本寄存起来。

`p` 在光标后开始黏贴

`P` 大写的 P 光标前开始粘贴

#### 撤销和恢复

`u` 撤销刚才的操作

`ctrl + r` 恢复撤销操作

#### 删除字符和替换

`x` 删除光标当前所在的字符

`r` 替换掉光标当前所在的字符

`R` 替换掉从光标开始以后的所有字符，除非 `<ESC >` 退出

#### 大小写转换

`~` 将光标下的字母改变大小写
`3~` 将光标位置开始的3个字母改变其大小写
`g~~` 改变当前行字母的大小写
`gUU` 将当前行的字母改成大写
`guu` 将当前行的字母全改成小写

`3gUU` 将从光标开始到下面3行字母改成大写
`gUw` 将光标下的单词改成大写。
`guw` 将光标下的单词改成小写

#### 重复操作

`.` 该命令是重复上一个操作的命令
`n<command>`重复某个命令 n 次，
如 `10p`粘贴 10 次，10dd 删除十次。

### VIM可视模式快捷键

在正常模式下快速移动光标的操作也同样适用于可视模式

- 如果当前光标在`{}[]""‘’()`内部的话，按下`a`和对应的括号可以快速选中选区中的内容（包括括号或引号）也可以用`i`（不包括括号或引号）

  例如进入可视模式之后`i}`选中函数中的内容

  <img src="/home/LanQiDongLai/.config/Typora/typora-user-images/image-20230905151445070.png" alt="image-20230905151445070" style="zoom:80%;" />

### VIM宏录制

在正常模式下依次输入`q{字母}{操作序列...}q`即可录制宏到指定的容器中，字母为容器的标识

例如在正常模式下输入`qmO//<ESC>q`则表示将`O//<ESC>`操作录制到m宏中，可用于快速在代码行前注释

在命令行下输入`@m`即可运行宏m，也可以输入`3@m`让宏连续执行三次

